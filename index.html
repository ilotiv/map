<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login to Moodle</title>
</head>
<body>
    <button id="loginButton">Login to Moodle</button>

    <script>
        document.getElementById('loginButton').addEventListener('click', async () => {
            try {
                const token = await fetch('fetch_token.php').then(response => response.text());
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = 'https://moodle.caseine.org/login/index.php';
                form.style.display = 'none';

                const inputUsername = document.createElement('input');
                inputUsername.name = 'username';
                inputUsername.value = 'testcna';
                form.appendChild(inputUsername);

                const inputPassword = document.createElement('input');
                inputPassword.name = 'password';
                inputPassword.value = '*TestCNA38+';
                form.appendChild(inputPassword);

                const inputToken = document.createElement('input');
                inputToken.name = 'logintoken';
                inputToken.value = token;
                form.appendChild(inputToken);

                document.body.appendChild(form);
                form.submit();
            } catch (error) {
                console.error('Error logging in:', error);
            }
        });
    </script>
</body>
</html>